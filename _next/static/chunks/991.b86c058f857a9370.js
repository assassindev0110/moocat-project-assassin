"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[991],{8447:function(e,t,i){i.d(t,{z:function(){return l}});var n=i(7437),r=i(4769);let l=e=>{let{disabled:t,stretched:i,children:l,className:h,...a}=e;return(0,n.jsx)("button",{...a,className:(0,r.m6)("font-display bg-blue text-white md:text-4xl text-2xl bg-red border-4 rounded-0 border-black rotate-[5deg] shadow px-5 py-3 transition-all ease-in-out",h,t?"opacity-50 cursor-not-allowed":"opacity-100 md:hover:scale-105"),children:l})}},3991:function(e,t,i){i.r(t),i.d(t,{default:function(){return c}});var n=i(7437),r=i(2265),l=i(8612),h=i(5175),a=i.n(h),s=i(8447),d=i(536);function c(){let[e,t]=(0,r.useState)(null),[i,l]=(0,r.useState)(!1),[h,a]=(0,r.useState)(!1),[d,c]=(0,r.useState)({width:500,height:500}),g=(0,r.useRef)(null),[m,w]=(0,r.useState)(!1),[x,f]=(0,r.useState)("/img/helmet/helmet.png"),p=()=>{if(e){let t=new Image;t.src=e,t.onload=()=>{let e,i;let n=window.innerWidth,r=t.width/t.height;r>=1?i=(e=Math.min(500,n))/r:e=(i=Math.min(500,n/r))*r,c({width:.9*e,height:.9*i})}}else{let e=Math.min(window.innerWidth,500);c({width:.9*e,height:.9*e})}};(0,r.useEffect)(()=>(p(),window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)),[e]),(0,r.useEffect)(()=>{let t=()=>{e&&p()};return t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[]);let b=e=>{l(!1),a(!0);let t={width:e.current.width(),height:e.current.height()},i={x:e.current.scaleX(),y:e.current.scaleY()};e.current.width(2*t.width),e.current.height(2*t.height),e.current.scale({x:2,y:2}),setTimeout(()=>{let n=e.current.toDataURL(),r=document.createElement("a");r.href=n,r.download="canvas-image.png",document.body.appendChild(r),r.click(),document.body.removeChild(r),e.current.width(t.width),e.current.height(t.height),e.current.scale(i)},500)},j=null!==e;return(0,r.useEffect)(()=>{f(null),l(!1),setTimeout(()=>{f(m?"/img/helmet/helmet-flipped.png":"/img/helmet/helmet.png")},100)},[m]),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(u,{isSelected:i,setIsSelected:l,ref:g,uploadedImage:e,helmetImage:x,stageSize:d,hasTappedHelmet:h,setHasTappedHelmet:a}),j&&(0,n.jsx)("div",{onClick:()=>t(null),className:"absolute cursor-pointer md:hover:scale-105 transition-all ease-in-out top-2 right-2 bg-red w-[50px] h-[50px] flex items-center justify-center rounded-full border-4 border-black",children:(0,n.jsx)("div",{className:"text-white text-[20px] mt-[-1px]",children:"x"})}),j&&(0,n.jsx)("div",{onClick:()=>w(!m),className:"absolute cursor-pointer md:hover:scale-105 transition-all ease-in-out top-2 left-2 bg-skin h-[50px] px-2 flex items-center justify-center border-4 border-black",children:(0,n.jsx)("div",{className:"text-black text-[20px] mt-[-1px]",children:"flip"})}),(0,n.jsxs)("div",{className:"flex flex-col items-center md:pt-5 pt-3",children:[(0,n.jsx)(o,{onUpload:t,hasImage:j}),e&&(0,n.jsx)(s.z,{className:"rotate-[2deg]",onClick:()=>b(g),children:"Save Image"})]})]})}let o=e=>{let{onUpload:t,hasImage:i}=e,l=(0,r.useRef)(null);return i?null:(0,n.jsxs)("div",{className:"md:pt-5 pt-3",children:[(0,n.jsx)("input",{type:"file",ref:l,onChange:e=>{let i=e.target.files[0],n=new FileReader;n.onloadend=()=>{t(n.result)},n.readAsDataURL(i)},style:{display:"none"}}),(0,n.jsx)(d.Z,{delay:1.2,children:(0,n.jsx)(s.z,{onClick:()=>{l.current&&l.current.click()},className:"rotate-[2deg]",children:"Add Image"})})]})},u=r.forwardRef((e,t)=>{let{uploadedImage:i,helmetImage:h,isSelected:s,setIsSelected:d,stageSize:c,setHasTappedHelmet:o,hasTappedHelmet:u}=e,[g]=a()(i),[m]=a()(h),[w,x]=(0,r.useState)({width:200,height:141}),f=(0,r.useRef)(null),p=(0,r.useRef)(null);(0,r.useEffect)(()=>{s&&f.current&&p.current&&(p.current.nodes([f.current]),p.current.getLayer().batchDraw())},[s]);let b=c.width,j=c.height,v={width:0,height:0};if(g){let e,t;b/j>g.width/g.height?(t=j,e=g.width*(t/g.height)):(e=b,t=g.height*(b/g.width)),v.x=(b-e)/2,v.y=j-t,v.width=e,v.height=t}return(0,n.jsx)(l.Hf,{width:c.width,height:c.height,className:"border-4 border-black transition-all ease-in-out",onClick:e=>{e.target.attrs.image||d(!1)},ref:t,children:(0,n.jsxs)(l.mh,{children:[g&&(0,n.jsx)(l.Ee,{image:g,...v,listening:!1,onClick:()=>d(!1),id:"helmet"}),m&&(0,n.jsxs)(r.Fragment,{children:[(0,n.jsx)(l.Ee,{ref:f,image:m,x:b/2-w.width/2,y:0,width:w.width,height:w.height,draggable:!0,onDragStart:()=>{o(!0)},onClick:()=>{d(!0),o(!0)},onTap:()=>{d(!0),o(!0)},onTransformEnd:e=>{let t=e.target;x({width:t.width(),height:t.height()}),d(!1)}}),s&&(0,n.jsx)(l.$T,{ref:p,keepRatio:!0,centeredScaling:!0,boundBoxFunc:(e,t)=>(t.width&&e.width?t.height=t.width*e.height/e.width:t.height&&e.height&&(t.width=t.height*e.width/e.height),t)}),g&&!s&&!u&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.UL,{x:b/2-w.width/2+20,y:w.height/2,width:w.width-40,height:28,fill:"#ed3b23",listening:!1,stroke:"black"}),(0,n.jsx)(l.xv,{text:"TAP TO RESIZE",x:b/2-w.width/2+25,y:w.height/2+5,fontSize:20,fill:"white",listening:!1})]})]})]})})});u.displayName="ImageCanvas"}}]);